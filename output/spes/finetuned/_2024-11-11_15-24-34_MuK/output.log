Running:
src/main.py --config config_files/spes_finetune_config.json --change_output --comment finetuning | per_sample_std | target soz ratio 0.3 | pos wt 3.0

Using device: cuda
Loading and preprocessing data ...
Loaded TRAIN data:
Features shape: (5320962, 36)
Number of unique trials: 10926
Label distribution: soz
0    9309
1    1617
Name: count, dtype: int64
Loaded TEST data:
Features shape: (258110, 36)
Number of unique trials: 530
Label distribution: soz
0    430
1    100
Name: count, dtype: int64
10926 samples may be used for training
530 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=36, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0-2): 3 x TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=31168, out_features=2, bias=True)
)
Total number of parameters: 245826
Trainable parameters: 245826
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.4624600410461426 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.4624600410461426 seconds
Avg batch val. time: 0.02720353182624368 seconds
Avg sample val. time: 0.0008725661151814011 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 2.782618 | accuracy: 0.462264 | precision: 0.676470 | AUROC: 0.461372 | AUPRC: 0.167907 | 
Starting training...
Epoch 1 SOZ sampling ratio: 30.25%
Epoch 1 Training Summary: epoch: 1.000000 | loss: 1.891180 | soz_ratio: 0.302489 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.749054670333862 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.749054670333862 seconds
Avg batch train. time: 0.03142998441618088 seconds
Avg sample train. time: 0.0009838051135213127 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31032776832580566 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3863939046859741 seconds
Avg batch val. time: 0.022729053216822007 seconds
Avg sample val. time: 0.0007290451031810832 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 1.700143 | accuracy: 0.779245 | precision: 0.720539 | AUROC: 0.606233 | AUPRC: 0.256955 | 
Epoch 2 SOZ sampling ratio: 30.32%
Epoch 2 Training Summary: epoch: 2.000000 | loss: 1.642907 | soz_ratio: 0.303222 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.663723707199097 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.70638918876648 seconds
Avg batch train. time: 0.03130523154610082 seconds
Avg sample train. time: 0.0009799001637165001 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3037989139556885 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3588622411092122 seconds
Avg batch val. time: 0.021109543594659542 seconds
Avg sample val. time: 0.0006770985681305891 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 1.764346 | accuracy: 0.779245 | precision: 0.687278 | AUROC: 0.570209 | AUPRC: 0.211869 | 
Epoch 3 SOZ sampling ratio: 30.46%
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.428390 | soz_ratio: 0.304595 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.675421237945557 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.696066538492838 seconds
Avg batch train. time: 0.03127504835816619 seconds
Avg sample train. time: 0.0009789553851814788 seconds
Epoch 4 SOZ sampling ratio: 29.83%
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.202722 | soz_ratio: 0.298279 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.677315711975098 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.691378831863403 seconds
Avg batch train. time: 0.03126134161363568 seconds
Avg sample train. time: 0.0009785263437546588 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.30857086181640625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.34628939628601074 seconds
Avg batch val. time: 0.020369964487412396 seconds
Avg sample val. time: 0.0006533762194075674 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 2.187394 | accuracy: 0.760377 | precision: 0.712456 | AUROC: 0.538395 | AUPRC: 0.211480 | 
Epoch 5 SOZ sampling ratio: 30.67%
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.058319 | soz_ratio: 0.306700 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.698078632354736 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.69271879196167 seconds
Avg batch train. time: 0.03126525962561892 seconds
Avg sample train. time: 0.0009786489833389777 seconds
Epoch 6 SOZ sampling ratio: 30.07%
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.910621 | soz_ratio: 0.300659 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.68341326713562 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.691167871157328 seconds
Avg batch train. time: 0.03126072476946587 seconds
Avg sample train. time: 0.0009785070356175477 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3150463104248047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3400407791137695 seconds
Avg batch val. time: 0.020002398771398207 seconds
Avg sample val. time: 0.0006415863756863575 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 2.685557 | accuracy: 0.726415 | precision: 0.714462 | AUROC: 0.502930 | AUPRC: 0.212511 | 
Epoch 7 SOZ sampling ratio: 29.85%
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.777740 | soz_ratio: 0.298462 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.69828724861145 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.692184925079346 seconds
Avg batch train. time: 0.031263698611343115 seconds
Avg sample train. time: 0.0009786001212776264 seconds
Epoch 8 SOZ sampling ratio: 30.47%
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.726609 | soz_ratio: 0.304686 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.71372127532959 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.694876968860626 seconds
Avg batch train. time: 0.031271570084387794 seconds
Avg sample train. time: 0.0009788465100549722 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.30739545822143555 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.33459989229838055 seconds
Avg batch val. time: 0.01968234660578709 seconds
Avg sample val. time: 0.0006313205515063784 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 3.301841 | accuracy: 0.654717 | precision: 0.691351 | AUROC: 0.509744 | AUPRC: 0.190987 | 
Epoch 9 SOZ sampling ratio: 30.22%
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.650928 | soz_ratio: 0.302215 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.696495532989502 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.69505680931939 seconds
Avg batch train. time: 0.03127209593368242 seconds
Avg sample train. time: 0.0009788629699175719 seconds
Epoch 10 SOZ sampling ratio: 29.61%
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.615064 | soz_ratio: 0.296083 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.706150770187378 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.69616620540619 seconds
Avg batch train. time: 0.03127533978188944 seconds
Avg sample train. time: 0.0009789645071761111 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3101041316986084 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.33110049792698454 seconds
Avg batch val. time: 0.019476499878057912 seconds
Avg sample val. time: 0.0006247179206169519 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.091921 | accuracy: 0.716981 | precision: 0.714796 | AUROC: 0.565256 | AUPRC: 0.231004 | 
Epoch 11 SOZ sampling ratio: 30.22%
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.569023 | soz_ratio: 0.302215 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.73054027557373 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.699291120875966 seconds
Avg batch train. time: 0.03128447696162563 seconds
Avg sample train. time: 0.0009792505144495668 seconds
Epoch 12 SOZ sampling ratio: 29.69%
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.540164 | soz_ratio: 0.296906 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.722820043563843 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.701251864433289 seconds
Avg batch train. time: 0.0312902101299219 seconds
Avg sample train. time: 0.0009794299711178187 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31054258346557617 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.32853075861930847 seconds
Avg batch val. time: 0.019325338742312265 seconds
Avg sample val. time: 0.0006198693558854876 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 3.802869 | accuracy: 0.728302 | precision: 0.680953 | AUROC: 0.514581 | AUPRC: 0.187499 | 
Epoch 13 SOZ sampling ratio: 29.79%
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.519486 | soz_ratio: 0.297913 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.724900245666504 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.703070970681997 seconds
Avg batch train. time: 0.03129552915404093 seconds
Avg sample train. time: 0.0009795964644592713 seconds
Epoch 14 SOZ sampling ratio: 30.38%
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.485609 | soz_ratio: 0.303771 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.725574970245361 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.704678399222237 seconds
Avg batch train. time: 0.03130022923749192 seconds
Avg sample train. time: 0.0009797435840401096 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31195616722106934 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.32668913735283744 seconds
Avg batch val. time: 0.019217008079578674 seconds
Avg sample val. time: 0.0006163945987789386 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 4.408762 | accuracy: 0.673585 | precision: 0.669775 | AUROC: 0.475500 | AUPRC: 0.178659 | 
Epoch 15 SOZ sampling ratio: 30.14%
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.489642 | soz_ratio: 0.301391 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.726883172988892 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.706158717473349 seconds
Avg batch train. time: 0.03130455765343084 seconds
Avg sample train. time: 0.000979879069876748 seconds
Epoch 16 SOZ sampling ratio: 29.27%
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.410004 | soz_ratio: 0.292696 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.713698625564575 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.70662996172905 seconds
Avg batch train. time: 0.03130593556061126 seconds
Avg sample train. time: 0.0009799222004145203 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.30268239974975586 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3242884635925293 seconds
Avg batch val. time: 0.019075791976031133 seconds
Avg sample val. time: 0.0006118650256462816 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 4.471516 | accuracy: 0.709434 | precision: 0.676689 | AUROC: 0.480767 | AUPRC: 0.173493 | 
Epoch 17 SOZ sampling ratio: 30.07%
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.458675 | soz_ratio: 0.300659 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.744946241378784 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.708883860531975 seconds
Avg batch train. time: 0.03131252590798823 seconds
Avg sample train. time: 0.0009801284880589396 seconds
Epoch 18 SOZ sampling ratio: 29.79%
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.435332 | soz_ratio: 0.297913 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.72007155418396 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.709505399068197 seconds
Avg batch train. time: 0.03131434327212923 seconds
Avg sample train. time: 0.0009801853742511621 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3117074966430664 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3231447393243963 seconds
Avg batch val. time: 0.019008514077905665 seconds
Avg sample val. time: 0.0006097070553290496 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 4.386193 | accuracy: 0.700000 | precision: 0.686744 | AUROC: 0.495023 | AUPRC: 0.179795 | 
Epoch 19 SOZ sampling ratio: 30.13%
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.389515 | soz_ratio: 0.301300 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.719305992126465 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.710021219755474 seconds
Avg batch train. time: 0.031315851519752844 seconds
Avg sample train. time: 0.0009802325846380627 seconds
Epoch 20 SOZ sampling ratio: 29.85%
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.331850 | soz_ratio: 0.298462 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.734279870986938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.711234152317047 seconds
Avg batch train. time: 0.031319398106190194 seconds
Avg sample train. time: 0.0009803435980520819 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3096616268157959 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.32202114661534625 seconds
Avg batch val. time: 0.018942420389138015 seconds
Avg sample val. time: 0.0006075870690855589 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 4.940440 | accuracy: 0.750943 | precision: 0.706891 | AUROC: 0.507256 | AUPRC: 0.200194 | 
Early stopping triggered
Best accuracy was 0.779245283018868. Other metrics: {'epoch': 1, 'loss': 1.700143108727797, 'accuracy': 0.779245283018868, 'precision': 0.7205393954622497, 'AUROC': 0.6062325581395348, 'AUPRC': 0.2569546963836581}
All Done!
Total runtime: 0.0 hours, 3.0 minutes, 58.98446750640869 seconds

