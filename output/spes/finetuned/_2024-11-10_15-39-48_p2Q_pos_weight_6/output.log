Running:
src/main.py --config config_files/spes_finetune_config.json --change_output

Using device: cuda
Loading and preprocessing data ...
Loaded TRAIN data:
Features shape: (5320962, 36)
Number of unique trials: 10926
Label distribution: soz
0    9309
1    1617
Name: count, dtype: int64
Loaded TEST data:
Features shape: (258110, 36)
Number of unique trials: 530
Label distribution: soz
0    430
1    100
Name: count, dtype: int64
10926 samples may be used for training
530 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=36, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0-2): 3 x TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=31168, out_features=2, bias=True)
)
Total number of parameters: 245826
Trainable parameters: 245826
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3919394016265869 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3919394016265869 seconds
Avg batch val. time: 0.023055258919210994 seconds
Avg sample val. time: 0.0007395083049558243 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 14.550820 | accuracy: 0.447170 | precision: 0.665265 | AUROC: 0.466907 | AUPRC: 0.182274 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 3.195638 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.070159435272217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.070159435272217 seconds
Avg batch train. time: 0.029444910629450927 seconds
Avg sample train. time: 0.000921669360724164 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2702827453613281 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3311110734939575 seconds
Avg batch val. time: 0.019477121970232797 seconds
Avg sample val. time: 0.0006247378745169009 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 3.321220 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.467163 | AUPRC: 0.184040 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 2.971967 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.041717052459717 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.055938243865967 seconds
Avg batch train. time: 0.029403328198438498 seconds
Avg sample train. time: 0.0009203677689791293 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2820155620574951 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3147459030151367 seconds
Avg batch val. time: 0.018514464883243337 seconds
Avg sample val. time: 0.0005938601943681824 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 4.445506 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.413884 | AUPRC: 0.153704 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 3.176919 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.028812646865845 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.046896378199259 seconds
Avg batch train. time: 0.029376889994734676 seconds
Avg sample train. time: 0.0009195402140032271 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 3.021234 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.03693413734436 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.044405817985535 seconds
Avg batch train. time: 0.029369607654928465 seconds
Avg sample train. time: 0.0009193122659697542 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2670738697052002 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3028278946876526 seconds
Avg batch val. time: 0.017813405569861916 seconds
Avg sample val. time: 0.0005713733862031181 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 3.390176 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.426465 | AUPRC: 0.162420 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 3.013982 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.048091650009155 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.045142984390258 seconds
Avg batch train. time: 0.029371763112252217 seconds
Avg sample train. time: 0.0009193797349798882 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 2.992295 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.07241940498352 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.049689054489136 seconds
Avg batch train. time: 0.029385055714880513 seconds
Avg sample train. time: 0.0009197958131511198 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27728843688964844 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.29772000312805175 seconds
Avg batch val. time: 0.01751294136047363 seconds
Avg sample val. time: 0.0005617358549585882 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 3.754597 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.423837 | AUPRC: 0.153844 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 2.989842 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.083045721054077 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.054454292569842 seconds
Avg batch train. time: 0.02939898915956094 seconds
Avg sample train. time: 0.0009202319506287609 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 2.956522 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.07305121421814 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.056778907775879 seconds
Avg batch train. time: 0.02940578628004643 seconds
Avg sample train. time: 0.0009204447105780596 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27196288108825684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2934271494547526 seconds
Avg batch val. time: 0.01726042055616192 seconds
Avg sample val. time: 0.000553636131046703 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 3.259824 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.445581 | AUPRC: 0.163333 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 2.954622 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.066142797470093 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.057819339964125 seconds
Avg batch train. time: 0.029408828479427267 seconds
Avg sample train. time: 0.0009205399359293543 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 2.918243 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.0715970993042 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.059197115898133 seconds
Avg batch train. time: 0.02941285706402963 seconds
Avg sample train. time: 0.000920666036600598 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2770864963531494 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.29109277044023785 seconds
Avg batch val. time: 0.017123104143543403 seconds
Avg sample val. time: 0.0005492316423400714 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.233400 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.439326 | AUPRC: 0.161409 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 2.873600 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.08484411239624 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.061528661034323 seconds
Avg batch train. time: 0.02941967444746878 seconds
Avg sample train. time: 0.0009208794308103902 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 2.882187 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.08451795578003 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.063444435596466 seconds
Avg batch train. time: 0.029425276127475048 seconds
Avg sample train. time: 0.0009210547717002074 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2738313674926758 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2889350950717926 seconds
Avg batch val. time: 0.016996182063046622 seconds
Avg sample val. time: 0.0005451605567392314 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 3.372167 | accuracy: 0.809434 | precision: 0.657952 | AUROC: 0.462209 | AUPRC: 0.172549 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 2.896891 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.090535402297974 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.065528356111967 seconds
Avg batch train. time: 0.02943136946231569 seconds
Avg sample train. time: 0.0009212455021153182 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 2.882646 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.10584306716919 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.06840797833034 seconds
Avg batch train. time: 0.02943978941032263 seconds
Avg sample train. time: 0.0009215090589722076 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2763631343841553 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.28753821055094403 seconds
Avg batch val. time: 0.016914012385349647 seconds
Avg sample val. time: 0.000542524925567819 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 3.386935 | accuracy: 0.813208 | precision: 0.848165 | AUROC: 0.473209 | AUPRC: 0.185102 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 2.868534 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.082230806350708 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.069329500198364 seconds
Avg batch train. time: 0.029442483918708667 seconds
Avg sample train. time: 0.000921593401079843 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 2.856754 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.098883867263794 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.071176648139954 seconds
Avg batch train. time: 0.029447884936081737 seconds
Avg sample train. time: 0.0009217624609317183 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.270885705947876 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.28587296009063723 seconds
Avg batch val. time: 0.016816056475919838 seconds
Avg sample val. time: 0.0005393829435672401 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 3.560535 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.407023 | AUPRC: 0.151123 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 2.828372 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.086203813552856 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.072060599046594 seconds
Avg batch train. time: 0.02945046958785554 seconds
Avg sample train. time: 0.0009218433643645061 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 2.840161 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.103402137756348 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.07380179564158 seconds
Avg batch train. time: 0.029455560805969533 seconds
Avg sample train. time: 0.0009220027270402325 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2766299247741699 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.28503268415277655 seconds
Avg batch val. time: 0.01676662847957509 seconds
Avg sample val. time: 0.0005377975172693897 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 3.344853 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.381163 | AUPRC: 0.164788 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 2.826175 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.09718132019043 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.075032296933626 seconds
Avg batch train. time: 0.02945915876296382 seconds
Avg sample train. time: 0.000922115348428851 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 2.837184 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.082667827606201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.075414073467254 seconds
Avg batch train. time: 0.029460275068617703 seconds
Avg sample train. time: 0.000922150290450966 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2799959182739258 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2846129536628723 seconds
Avg batch val. time: 0.016741938450757193 seconds
Avg sample val. time: 0.0005370055729488157 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 3.393853 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.440233 | AUPRC: 0.175690 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 2.838983 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.100094318389893 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.076589323225475 seconds
Avg batch train. time: 0.029463711471419518 seconds
Avg sample train. time: 0.0009222578549538235 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 2.833183 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.100524425506592 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.07767728242007 seconds
Avg batch train. time: 0.02946689263865518 seconds
Avg sample train. time: 0.0009223574302050221 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27942609786987305 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.28421396475571853 seconds
Avg batch val. time: 0.016718468515042266 seconds
Avg sample val. time: 0.000536252763690035 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 3.403879 | accuracy: 0.809434 | precision: 0.657952 | AUROC: 0.414860 | AUPRC: 0.154542 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 2.830931 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.112558126449585 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.079193840856137 seconds
Avg batch train. time: 0.029471327020047185 seconds
Avg sample train. time: 0.0009224962329174571 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 2.851624 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.089475870132446 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.079622258742651 seconds
Avg batch train. time: 0.02947257970392588 seconds
Avg sample train. time: 0.000922535443780217 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2718048095703125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2833275965281895 seconds
Avg batch val. time: 0.016666329207540558 seconds
Avg sample val. time: 0.0005345803708079048 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 3.481659 | accuracy: 0.811321 | precision: 0.811321 | AUROC: 0.392698 | AUPRC: 0.145009 | 
Early stopping triggered
Best accuracy was 0.8132075471698114. Other metrics: {'epoch': 14, 'loss': 3.3869346762603185, 'accuracy': 0.8132075471698114, 'precision': 0.8481649249206407, 'AUROC': 0.4732093023255814, 'AUPRC': 0.1851019080344833}
All Done!
Total runtime: 0.0 hours, 4.0 minutes, 25.850246906280518 seconds

