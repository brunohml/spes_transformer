Running:
src/main.py --config config_files/spes_finetune_config.json --change_output --comment finetuning | per_sample_std | target soz ratio 0.3 | pos wt 6.0

Using device: cuda
Loading and preprocessing data ...
Loaded TRAIN data:
Features shape: (5320962, 36)
Number of unique trials: 10926
Label distribution: soz
0    9309
1    1617
Name: count, dtype: int64
Loaded TEST data:
Features shape: (258110, 36)
Number of unique trials: 530
Label distribution: soz
0    430
1    100
Name: count, dtype: int64
10926 samples may be used for training
530 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=36, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0-2): 3 x TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=31168, out_features=2, bias=True)
)
Total number of parameters: 245826
Trainable parameters: 245826
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.43496108055114746 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.43496108055114746 seconds
Avg batch val. time: 0.02558594591477338 seconds
Avg sample val. time: 0.0008206812840587688 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 4.855822 | accuracy: 0.471698 | precision: 0.702670 | AUROC: 0.485907 | AUPRC: 0.181536 | 
Starting training...
Epoch 1 SOZ sampling ratio: 30.29%
Epoch 1 Training Summary: epoch: 1.000000 | loss: 2.525314 | soz_ratio: 0.302947 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.761434316635132 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.761434316635132 seconds
Avg batch train. time: 0.031466182212383426 seconds
Avg sample train. time: 0.0009849381582129903 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31961941719055176 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3772902488708496 seconds
Avg batch val. time: 0.02219354405122645 seconds
Avg sample val. time: 0.0007118683940959427 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 2.553696 | accuracy: 0.701887 | precision: 0.697242 | AUROC: 0.473791 | AUPRC: 0.176239 | 
Epoch 2 SOZ sampling ratio: 29.47%
Epoch 2 Training Summary: epoch: 2.000000 | loss: 2.221405 | soz_ratio: 0.294710 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.662541627883911 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.711987972259521 seconds
Avg batch train. time: 0.03132160225806878 seconds
Avg sample train. time: 0.0009804125912739815 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31371545791625977 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.35609865188598633 seconds
Avg batch val. time: 0.020946979522705078 seconds
Avg sample val. time: 0.0006718842488414836 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 2.537392 | accuracy: 0.720755 | precision: 0.681018 | AUROC: 0.479791 | AUPRC: 0.172546 | 
Epoch 3 SOZ sampling ratio: 29.92%
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.903983 | soz_ratio: 0.299195 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.648561239242554 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.690845727920532 seconds
Avg batch train. time: 0.031259782830176996 seconds
Avg sample train. time: 0.0009784775515211909 seconds
Epoch 4 SOZ sampling ratio: 30.14%
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.712022 | soz_ratio: 0.301391 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.673475980758667 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.686503291130066 seconds
Avg batch train. time: 0.031247085646579142 seconds
Avg sample train. time: 0.000978080110848441 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.30809617042541504 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3440980315208435 seconds
Avg batch val. time: 0.020241060677696678 seconds
Avg sample val. time: 0.0006492415689072519 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 3.297792 | accuracy: 0.662264 | precision: 0.675866 | AUROC: 0.456837 | AUPRC: 0.165296 | 
Epoch 5 SOZ sampling ratio: 30.25%
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.442266 | soz_ratio: 0.302489 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.687333822250366 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.686669397354127 seconds
Avg batch train. time: 0.03124757133729277 seconds
Avg sample train. time: 0.000978095313687912 seconds
Epoch 6 SOZ sampling ratio: 29.99%
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.284803 | soz_ratio: 0.299927 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.708072185516357 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.690236528714498 seconds
Avg batch train. time: 0.03125800154594883 seconds
Avg sample train. time: 0.0009784217946837359 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3081817626953125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3369147777557373 seconds
Avg batch val. time: 0.019818516338572782 seconds
Avg sample val. time: 0.0006356882599164855 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 3.557651 | accuracy: 0.705660 | precision: 0.701077 | AUROC: 0.489907 | AUPRC: 0.209421 | 
Epoch 7 SOZ sampling ratio: 29.87%
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.096475 | soz_ratio: 0.298737 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.676197052001953 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.688230889184135 seconds
Avg batch train. time: 0.03125213710287759 seconds
Avg sample train. time: 0.0009782382289203859 seconds
Epoch 8 SOZ sampling ratio: 30.37%
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.057177 | soz_ratio: 0.303679 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.70285677909851 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.690059125423431 seconds
Avg batch train. time: 0.03125748282287553 seconds
Avg sample train. time: 0.00097840555788243 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31723475456237793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3336347738901774 seconds
Avg batch val. time: 0.019625574934716318 seconds
Avg sample val. time: 0.0006294995733776933 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 3.925739 | accuracy: 0.728302 | precision: 0.705933 | AUROC: 0.539302 | AUPRC: 0.202781 | 
Epoch 9 SOZ sampling ratio: 29.64%
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.919317 | soz_ratio: 0.296357 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.715880632400513 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.692928181754219 seconds
Avg batch train. time: 0.031265871876474324 seconds
Avg sample train. time: 0.0009786681476985372 seconds
Epoch 10 SOZ sampling ratio: 29.88%
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.758033 | soz_ratio: 0.298828 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.706411123275757 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.694276475906372 seconds
Avg batch train. time: 0.03126981425703618 seconds
Avg sample train. time: 0.000978791550055498 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31998205184936523 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.33168438502720426 seconds
Avg batch val. time: 0.019510846178070838 seconds
Avg sample val. time: 0.0006258195943909514 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 4.901118 | accuracy: 0.741509 | precision: 0.719360 | AUROC: 0.528081 | AUPRC: 0.215624 | 
Epoch 11 SOZ sampling ratio: 29.64%
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.767719 | soz_ratio: 0.296449 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.710578680038452 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.695758494463833 seconds
Avg batch train. time: 0.031274147644631094 seconds
Avg sample train. time: 0.0009789271915123406 seconds
Epoch 12 SOZ sampling ratio: 29.73%
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.739968 | soz_ratio: 0.297273 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.7315354347229 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.69873990615209 seconds
Avg batch train. time: 0.03128286522266693 seconds
Avg sample train. time: 0.0009792000646304312 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.313096284866333 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.32936087250709534 seconds
Avg batch val. time: 0.019374168971005606 seconds
Avg sample val. time: 0.0006214356085039534 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 5.959221 | accuracy: 0.705660 | precision: 0.693916 | AUROC: 0.489209 | AUPRC: 0.185584 | 
Epoch 13 SOZ sampling ratio: 30.69%
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.692584 | soz_ratio: 0.306883 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.71966028213501 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.700349165843082 seconds
Avg batch train. time: 0.03128757066035989 seconds
Avg sample train. time: 0.0009793473518069818 seconds
Epoch 14 SOZ sampling ratio: 30.41%
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.693021 | soz_ratio: 0.304137 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.719080686569214 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.701687131609235 seconds
Avg batch train. time: 0.03129148284096268 seconds
Avg sample train. time: 0.0009794698088604462 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3031272888183594 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3264460298750136 seconds
Avg batch val. time: 0.019202707639706683 seconds
Avg sample val. time: 0.000615935905424554 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 6.689478 | accuracy: 0.694340 | precision: 0.689572 | AUROC: 0.499593 | AUPRC: 0.203098 | 
Epoch 15 SOZ sampling ratio: 30.05%
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.643584 | soz_ratio: 0.300476 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.725330591201782 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.70326336224874 seconds
Avg batch train. time: 0.031296091702481696 seconds
Avg sample train. time: 0.0009796140730595588 seconds
Epoch 16 SOZ sampling ratio: 30.69%
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.618484 | soz_ratio: 0.306883 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.71473217010498 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.703980162739754 seconds
Avg batch train. time: 0.03129818761035016 seconds
Avg sample train. time: 0.0009796796780834481 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3052206039428711 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3243234872817993 seconds
Avg batch val. time: 0.01907785219304702 seconds
Avg sample val. time: 0.0006119311080788666 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 6.743883 | accuracy: 0.737736 | precision: 0.685023 | AUROC: 0.498023 | AUPRC: 0.210005 | 
Epoch 17 SOZ sampling ratio: 29.89%
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.619702 | soz_ratio: 0.298920 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.717718362808228 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.704788292155547 seconds
Avg batch train. time: 0.03130055056185832 seconds
Avg sample train. time: 0.0009797536419692062 seconds
Epoch 18 SOZ sampling ratio: 30.00%
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.562625 | soz_ratio: 0.300018 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.72831106185913 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.706095112694634 seconds
Avg batch train. time: 0.031304371674545715 seconds
Avg sample train. time: 0.0009798732484618921 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31589460372924805 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.32355722514065827 seconds
Avg batch val. time: 0.019032777949450488 seconds
Avg sample val. time: 0.0006104853304540722 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 6.912639 | accuracy: 0.737736 | precision: 0.688271 | AUROC: 0.517465 | AUPRC: 0.193038 | 
Epoch 19 SOZ sampling ratio: 30.08%
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.581918 | soz_ratio: 0.300842 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.718311071395874 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.706738057889437 seconds
Avg batch train. time: 0.031306251631255666 seconds
Avg sample train. time: 0.000979932093894329 seconds
Epoch 20 SOZ sampling ratio: 29.68%
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.547927 | soz_ratio: 0.296815 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.714790344238281 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.70714067220688 seconds
Avg batch train. time: 0.03130742886610199 seconds
Avg sample train. time: 0.000979968943090507 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.31136584281921387 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3225412766138713 seconds
Avg batch val. time: 0.018973016271404193 seconds
Avg sample val. time: 0.0006085684464412665 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 7.385446 | accuracy: 0.686792 | precision: 0.676829 | AUROC: 0.500000 | AUPRC: 0.186037 | 
Epoch 21 SOZ sampling ratio: 30.57%
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.543756 | soz_ratio: 0.305693 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.709336519241333 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.707245236351376 seconds
Avg batch train. time: 0.03130773460921455 seconds
Avg sample train. time: 0.000979978513303256 seconds
Epoch 22 SOZ sampling ratio: 29.92%
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.530729 | soz_ratio: 0.299195 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 10.7093186378479 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 10.707339481873946 seconds
Avg batch train. time: 0.03130801018091797 seconds
Avg sample train. time: 0.000979987139106164 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.30685877799987793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.321334930566641 seconds
Avg batch val. time: 0.018902054739214174 seconds
Avg sample val. time: 0.0006062923218238509 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 8.596753 | accuracy: 0.732075 | precision: 0.700056 | AUROC: 0.497558 | AUPRC: 0.190739 | 
Early stopping triggered
Best accuracy was 0.7415094339622641. Other metrics: {'epoch': 10, 'loss': 4.901118382867777, 'accuracy': 0.7415094339622641, 'precision': 0.7193599447556236, 'AUROC': 0.5280813953488371, 'AUPRC': 0.21562363110517468}
All Done!
Total runtime: 0.0 hours, 4.0 minutes, 20.669808626174927 seconds

